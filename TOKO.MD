
## ğŸ­ Role User (di `user_profiles.role`)

```ts
'admin' | 'shop' | 'user'
```

### Penjelasan

| Role      | Bisa                                 |
| --------- | ------------------------------------ |
| **user**  | Pesan makanan, lihat history, review |
| **shop**  | Kelola toko & menu                   |
| **admin** | Verifikasi toko, moderasi            |

âŒ Tidak ada role `pending`

---

# ğŸª STATUS TOKO (BUKAN ROLE)

Verifikasi **melekat di toko**, bukan user.

Di tabel `shops`:

```sql
is_verified BOOLEAN DEFAULT false
is_active BOOLEAN DEFAULT true
```

---

# ğŸ” FLOW YANG BENAR (SESUAI KEINGINAN KAMU)

```
USER (role=user)
 â†“ daftar toko
SHOP dibuat (is_verified = false)
 â†“ admin approve
role user â†’ shop
```

---

# ğŸ‘¤ UI USER BIASA (AKUN)

### Halaman Akun

```
ğŸ‘¤ Akun Saya
-------------------
Nama
Email

ğŸŸ¦ Buka Toko
Mulai jualan makanan di sekitarmu

ğŸ“¦ Pesanan Saya
â¤ï¸ Favorit
âš™ï¸ Pengaturan
```

---

# ğŸ“ HALAMAN DAFTAR TOKO (USER â†’ TOKO)

ğŸ“ Route:

```
/buka-toko
```

### UI

```
ğŸ›ï¸ Buka Toko

Nama Toko*
Kategori*
WhatsApp*
Alamat*

Jam Buka - Jam Tutup

[ Upload Logo ]
[ Upload Banner ]

ğŸŸ§ AJUKAN TOKO
```

â¡ï¸ Submit â†’ data masuk ke `shops`
â¡ï¸ `is_verified = false`

---

# â³ SETELAH DAFTAR (MASIH USER)

### UI Feedback

```
â³ Pengajuan Toko Dikirim

Toko kamu sedang ditinjau admin.
Kami akan memberi tahu setelah disetujui.
```

â¡ï¸ Role tetap **user**
â¡ï¸ Menu toko **belum muncul**

---

# ğŸ›¡ï¸ UI ADMIN â€“ VERIFIKASI TOKO

ğŸ“ Route:

```
/admin/shops
```

### List

```
ğŸ•’ Toko Menunggu Verifikasi
--------------------------------
ğŸœ Warung Bu Sari
ğŸ“ Desa Sukamaju
ğŸ“ WA aktif

[ Approve ] [ Reject ]
```

---

# âœ… SAAT ADMIN APPROVE

### Backend

```sql
UPDATE shops SET is_verified = true WHERE id = ?
UPDATE user_profiles SET role = 'shop' WHERE id = owner_id
```

---

# ğŸ‰ LOGIN ULANG â†’ ROLE BERUBAH

User login ulang â†’ redirect otomatis:

| Role  | Redirect          |
| ----- | ----------------- |
| user  | `/`               |
| shop  | `/toko/dashboard` |
| admin | `/admin`          |

---

# ğŸª UI TOKO (SETELAH APPROVE)

### Sidebar / Menu

```
ğŸª Dashboard
ğŸ” Menu
ğŸ“¸ Gambar
ğŸ•’ Jam Operasional
âš™ï¸ Profil Toko
ğŸšª Logout
```

âŒ Tidak ada:

* Pesanan saya
* Favorit
* Review

> Fokus: **jualan**

---

# ğŸ”’ RLS (LOGIKA SINGKAT)

| Aksi                 | Boleh |
| -------------------- | ----- |
| User baca toko       | âœ…     |
| User CRUD menu       | âŒ     |
| Shop CRUD menu       | âœ…     |
| Shop lihat toko lain | âŒ     |
| Admin lihat semua    | âœ…     |

Siap. Kita bikin **alur + UI/UX sisi TOKO** yang **jelas, aman, dan tidak ribet**, sesuai konsep kamu:

> ğŸ”‘ **User biasa â†’ daftar toko â†’ diverifikasi admin â†’ berubah role jadi TOKO (bukan user biasa lagi)**

Aku jelaskan **step-by-step + tampilan halaman**.

---

# ğŸ§‘â€ğŸ’¼ KONSEP ROLE (PENTING, BIAR JELAS)

### ğŸ­ Role yang ada

1. **USER**

   * Bisa pesan makanan
   * Bisa login Google
   * Bisa daftar toko

2. **PENDING_TOKO**

   * Sudah daftar
   * Menunggu verifikasi admin
   * Tidak bisa jualan

3. **TOKO**

   * Bisa kelola menu
   * Terima pesanan WA
   * Tidak bisa pesan seperti user biasa

> âœ… Setelah disetujui â†’ **role berubah permanen ke TOKO**

---

# ğŸ‘¤ HALAMAN USER â€“ TOMBOL â€œBUKA TOKOâ€

ğŸ“ **Lokasi:**

* Halaman Akun / Profil

### UI

```
ğŸ‘¤ Akun Saya
---------------------
Nama: Irfan
Login: Google

ğŸŸ¦ Buka Toko Anda
Mulai jualan makanan di sekitar Anda
```

â¡ï¸ Klik **Buka Toko** â†’ ke halaman pendaftaran toko

---

# ğŸ“ HALAMAN DAFTAR TOKO (FORM)

### ğŸ§± UI Struktur (1 halaman, ringan)

```
ğŸ›ï¸ Daftar Toko
-----------------------

Nama Toko*
Kategori*
(No dropdown ribet: Makanan / Minuman / Camilan)

No WhatsApp*
Alamat Singkat*
(deskripsi bebas)

Jam Buka
Jam Tutup

Upload Logo (opsional)
Upload Banner (opsional)

[ ] Saya menyatakan data benar

ğŸŸ§ AJUKAN TOKO
```

### UX Notes

* Form **sederhana**
* Tidak perlu KTP / legalitas dulu
* Cocok untuk UMKM desa

---

# â³ STATUS SETELAH DAFTAR

Setelah klik **Ajukan Toko** ğŸ‘‡

### UI Feedback

```
â³ Pengajuan Toko Dikirim

Toko Anda sedang menunggu verifikasi admin.
Proses biasanya 1x24 jam.

Kami akan memberi notifikasi setelah disetujui.
```

â¡ï¸ Akun berubah status:

```
USER â†’ PENDING_TOKO
```

---

# ğŸ›¡ï¸ HALAMAN ADMIN â€“ VERIFIKASI TOKO (KONSEP)

(Admin bisa manual, tidak perlu UI kompleks dulu)

### Data yang dicek admin:

* Nama toko
* WA aktif
* Alamat masuk akal
* Tidak duplikat

### Aksi Admin:

* âœ… Setujui
* âŒ Tolak (opsional alasan)

---

# ğŸ” SAAT ADMIN MENYETUJUI

### Backend Action

```
shops.is_verified = true
shops.is_active = true
```

Dan **role user berubah**:

```
auth.users.role = "shop"
```

atau via `user_profiles.role = 'shop'`

---

# ğŸ‰ UI SETELAH DISETUJUI (LOGIN ULANG)

Saat user login ulang:

### Redirect otomatis ke:

```
/toko/dashboard
```

### Popup / Banner

```
ğŸ‰ Selamat!
Toko Anda telah disetujui.
Sekarang Anda bisa mulai jualan.
```

---

# ğŸª DASHBOARD TOKO (UI/UX)

### Sidebar / Menu

```
ğŸª Dashboard
ğŸ“‹ Pesanan (via WA)
ğŸ” Menu Saya
ğŸ“¸ Kelola Foto
ğŸ•’ Jam Operasional
âš™ï¸ Pengaturan Toko
```

---

## ğŸ“‹ DASHBOARD UTAMA TOKO

### Tampilan

```
Halo, Toko Bu Sari ğŸ‘‹

ğŸ“¦ Total Menu: 12
ğŸ‘€ Dilihat: 120
ğŸ“² Pesanan Hari Ini: 5

ğŸŸ§ Tambah Menu
```

---

# ğŸ” HALAMAN KELOLA MENU (TOKO)

### List Menu

```
[IMG] Nasi Goreng  Rp 15.000  ğŸŸ¢
[IMG] Es Teh       Rp 5.000   ğŸŸ¢
```

* Toggle aktif/nonaktif
* Edit harga
* Hapus menu

---

# âŒ USER TIDAK BISA PESAN LAGI SETELAH JADI TOKO

### UX Handling

* Menu **Pesanan Saya** disembunyikan
* Diganti:

```
ğŸ“‹ Kelola Toko
```

ğŸ§  **Alasan UX**

* Menghindari role bingung
* Fokus 1 peran

---

# ğŸ” RLS & KEAMANAN (SINGKAT)

* `shops.owner_id = auth.uid()`
* User tanpa toko âŒ tidak bisa akses dashboard
* PENDING_TOKO âŒ tidak bisa input menu
* Hanya TOKO yang bisa CRUD menu

---

# ğŸ”„ FLOW RINGKAS (SUPER JELAS)

```
USER
 â†“ klik
BUKA TOKO
 â†“
ISI FORM
 â†“
PENDING_TOKO
 â†“ (admin approve)
TOKO
 â†“
DASHBOARD TOKO
```

---

# ğŸª DASHBOARD TOKO (UI/UX)

### Sidebar / Menu

```
ğŸª Dashboard
ğŸ“‹ Pesanan (via WA)
ğŸ” Menu Saya
ğŸ“¸ Kelola Foto
ğŸ•’ Jam Operasional
âš™ï¸ Pengaturan Toko
```

---

## ğŸ“‹ DASHBOARD UTAMA TOKO

### Tampilan

```
Halo, Toko Bu Sari ğŸ‘‹

ğŸ“¦ Total Menu: 12
ğŸ‘€ Dilihat: 120
ğŸ“² Pesanan Hari Ini: 5

ğŸŸ§ Tambah Menu
```

---

# ğŸ” HALAMAN KELOLA MENU (TOKO)

### List Menu

```
[IMG] Nasi Goreng  Rp 15.000  ğŸŸ¢
[IMG] Es Teh       Rp 5.000   ğŸŸ¢
```

* Toggle aktif/nonaktif
* Edit harga
* Hapus menu

---

# âŒ USER TIDAK BISA PESAN LAGI SETELAH JADI TOKO

### UX Handling

* Menu **Pesanan Saya** disembunyikan
* Diganti:

```
ğŸ“‹ Kelola Toko
```

ğŸ§  **Alasan UX**

* Menghindari role bingung
* Fokus 1 peran

---

# ğŸ” RLS & KEAMANAN (SINGKAT)

* `shops.owner_id = auth.uid()`
* User tanpa toko âŒ tidak bisa akses dashboard
* PENDING_TOKO âŒ tidak bisa input menu
* Hanya TOKO yang bisa CRUD menu

---

# ğŸ”„ FLOW RINGKAS (SUPER JELAS)

```
USER
 â†“ klik
BUKA TOKO
 â†“
ISI FORM
 â†“
PENDING_TOKO
 â†“ (admin approve)
TOKO
 â†“
DASHBOARD TOKO
```

---